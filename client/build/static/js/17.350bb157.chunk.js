(this["webpackJsonpink-crm"]=this["webpackJsonpink-crm"]||[]).push([[17],{167:function(e,t,n){"use strict";n.r(t);var r=n(30),a=n(5),c=n(0),l=n.n(c),i=n(27),u=n(2),o=n(3);function d(){var e=Object(u.a)(["\n  padding-left: 15px;\n  dt {\n    font-weight: bold;\n  }\n  dd:not(:last-child) {\n    margin-bottom: 10px;\n  }\n"]);return d=function(){return e},e}function m(){var e=Object(u.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]);return m=function(){return e},e}function s(){var e=Object(u.a)(["\n  background-color: white;\n  padding: 15px;\n"]);return s=function(){return e},e}function f(){var e=Object(u.a)(["\n  background-color: white;\n  padding: 15px;\n  display: flex;\n  flex-direction: column;\n"]);return f=function(){return e},e}function p(){var e=Object(u.a)(["\n  display: grid;\n  grid-template-columns: 4fr 8fr;\n  gap: 25px;\n"]);return p=function(){return e},e}var b=o.c.div(p()),v=o.c.div(f()),E=o.c.div(s()),h=o.c.div(m()),g=o.c.dl(d()),j=n(37),x=n(110),O=n(109),k=n(1);function y(){var e=Object(u.a)(["\n  border-top:"," 3px solid;\n  border-bottom-right-radius: 3px;\n  border-bottom-left-radius: 3px;\n  border-top-right-radius: 3px;\n  background: white;\n"]);return y=function(){return e},e}function w(){var e=Object(u.a)(["\n  color: ",";\n  margin-right: 10px;\n  cursor: pointer;\n  width: 20%;\n  border-top-left-radius: 3px;\n  border-top-right-radius: 3px;\n  background: ",";\n  text-align: center;\n  line-height: 3em;\n  \n  &.active {\n    background: ",";\n    color: white;\n  }\n"]);return w=function(){return e},e}function I(){var e=Object(u.a)(["\n  display: flex;\n"]);return I=function(){return e},e}function D(){var e=Object(u.a)(["\n"]);return D=function(){return e},e}var _=o.c.div(D()),C=o.c.div(I()),H=o.c.div(w(),k.d.darken("white",.75),k.d.lighten(k.a.backgroundDarkPrimary,1.5),k.d.lighten(k.a.backgroundDarkPrimary,.5)),P=o.c.div(y(),k.d.lighten(k.a.backgroundDarkPrimary,.5)),S=function(e){var t=e.tabs,n=Object(c.useState)(0),r=Object(a.a)(n,2),i=r[0],u=r[1];return Object(c.useEffect)((function(){u(0)}),[t]),t.length?l.a.createElement(_,null,l.a.createElement(C,null,t.map((function(e,t){return l.a.createElement(H,{key:t,className:t===i&&"active",onClick:function(){return u(t)}},e.label)}))),l.a.createElement(P,null,t[i].render)):null},Y=n(38),W=n.n(Y),F=n(112),J=n(33),M=n.n(J),N=function(e,t){var n=Object(c.useRef)();Object(c.useEffect)((function(){n.current=e}),[e]),Object(c.useEffect)((function(){if(null!==t){var e=setInterval((function(){return n.current.apply(n,arguments)}),t);return function(){return clearInterval(e)}}}),[t])},T=function(e){var t=e.phone,n=O.a.patch("/phone/".concat(t.id,"/")),r=Object(a.a)(n,2),i=r[0].isUpdating,u=r[1],o=O.a.post("/phone/".concat(t.id,"/verify/"),{type:"sms"}),d=Object(a.a)(o,2)[1],m=Object(c.useState)(0),s=Object(a.a)(m,2),f=s[0],p=s[1],b=Object(c.useCallback)(Object(F.a)(W.a.mark((function e(){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:return e.next=4,p(60);case 4:case"end":return e.stop()}}),e)}))),[d]);return N((function(){f>0&&p((function(e){return e-1}))}),1e3),l.a.createElement("div",null,l.a.createElement(j.c,{validations:{verification_code:j.c.is.match((function(e){return/^\d{4}$/.test(e)}),"\u041f\u0438\u043d-\u043a\u043e\u0434 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0438\u0437 4-\u0445 \u0446\u0438\u0444\u0440.")},initialValues:{verification_code:""},onSubmit:function(){var e=Object(F.a)(W.a.mark((function e(t,n){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u(t);case 3:M.a.emit("fetch-customer"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),j.c.handleAPIError(e.t0,n);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}()},l.a.createElement(x.e,null,l.a.createElement(x.f,null,"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u043d\u043e\u043c\u0435\u0440\u0430 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"),l.a.createElement(j.c.Field.Input,{name:"verification_code",label:"\u041f\u0438\u043d-\u043a\u043e\u0434"}),l.a.createElement(x.b,null,l.a.createElement(x.a,{type:"submit",variant:"primary",isWorking:i},"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c")),l.a.createElement(x.b,{style:{flexDirection:"column",alignItems:"center"}},l.a.createElement(x.a,{type:"button",variant:"empty",onClick:b,isWorking:f>0},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0438\u043d-\u043a\u043e\u0434 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u043f\u043e \u0421\u041c\u0421"),f>0&&l.a.createElement("h5",null,"\u041f\u043e\u0432\u0442\u043e\u0440\u043d\u0430\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u0430 \u0447\u0435\u0440\u0435\u0437 ",f," \u0441\u0435\u043a\u0443\u043d\u0434.")))))},q=n(115),z=n(28),A=n(62),L=n(21),R=n(50),U=[{Header:"#",accessor:"id",width:50},{Header:"Status",accessor:"status"},{Header:"Datetime",accessor:"datetime",Cell:function(e){var t=e.cell.value;return"".concat(Object(L.b)(t,"DD.MM.YYYY HH:mm"))}},{Header:"",accessor:"id",Cell:function(e){var t=e.cell.value;return l.a.createElement(R.a,{to:"/records/".concat(t)},l.a.createElement(z.a,{icon:"link",variant:"empty"},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438"))},className:"text-right"}],V=function(e){var t=e.records,n=Object(q.a)(),r=Object(i.h)().customerId;return l.a.createElement("div",null,l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},l.a.createElement("h3",null,"\u0417\u0430\u043f\u0438\u0441\u0438 \u0432 \u044d\u0442\u043e\u043c \u0441\u0430\u043b\u043e\u043d\u0435. \u0412\u0441\u0435\u0433\u043e \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u0443 \u044d\u0442\u043e\u0433\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0430: ",t.length,"."),l.a.createElement(R.a,{to:"/records/create/".concat(r)},l.a.createElement(z.a,{variant:"primary",icon:"plus-square"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"))),l.a.createElement("div",null,l.a.createElement(A.a,{columns:U,data:t.filter((function(e){return e.parlor.id===n.parlor.id}))})))};t.default=function(){var e,t,n=Object(i.h)().customerId,u=O.a.get("/customers/".concat(n,"/"),{},{mountFetch:!0}),o=Object(a.a)(u,2),d=o[0],m=d.isLoading,s=d.data,f=d.error,p=o[1];return Object(c.useEffect)((function(){return M.a.on("fetch-customer",p),function(){return M.a.off("fetch-customer",p)}}),[p]),m?l.a.createElement(j.j,null):f?l.a.createElement(j.i,null):l.a.createElement(b,null,l.a.createElement(v,null,l.a.createElement(h,null,l.a.createElement(j.a,{name:s.full_name,size:150}),l.a.createElement("h2",{style:{marginTop:"25px"}},s.full_name)),l.a.createElement(x.d,null),l.a.createElement("div",{style:{marginTop:"25px"}},l.a.createElement("h3",{style:{fontWeight:"bold"}},"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"),l.a.createElement(g,null,l.a.createElement("dt",null,"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"),l.a.createElement("dd",null,s.phone.number),l.a.createElement("dt",null,"Email"),l.a.createElement("dd",null,s.email||"\u2013"),l.a.createElement("dt",null,"\u0414\u0430\u0442\u0430 \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f"),l.a.createElement("dd",null,s.birth_date),l.a.createElement("dt",null,"\u041e\u0442\u043a\u0443\u0434\u0430 \u0443\u0437\u043d\u0430\u043b?"),l.a.createElement("dd",null,(null===(e=s.find_out)||void 0===e?void 0:e.name)||"\u2013"),l.a.createElement("dt",null,"\u0417\u0430\u043c\u0435\u0442\u043a\u0430"),l.a.createElement("dd",null,s.note||"\u2013")))),l.a.createElement(S,{tabs:[].concat(Object(r.a)((null===(t=s.phone)||void 0===t?void 0:t.confirmed)?[]:[{label:"\u0412\u0435\u0440\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f",render:l.a.createElement(E,null,l.a.createElement(T,{phone:s.phone}))}]),[{label:"\u0421\u0435\u0430\u043d\u0441\u044b",render:l.a.createElement(E,null,l.a.createElement(V,{records:s.records}))},{label:"\u041f\u043e\u043a\u0443\u043f\u043a\u0438",render:l.a.createElement(E,null,"\u041f\u043e\u043a\u0443\u043f\u043a\u0438")},{label:"\u041e\u0431\u0443\u0447\u0435\u043d\u0438\u044f",render:l.a.createElement(E,null,"\u041e\u0431\u0443\u0447\u0435\u043d\u0438\u044f")}])}))}}}]);
//# sourceMappingURL=17.350bb157.chunk.js.map