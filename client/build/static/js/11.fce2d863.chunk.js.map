{"version":3,"sources":["pages/Customer/Create/Styles.js","shared/utils/phoneNumberValidation.js","pages/Customer/Create/index.jsx"],"names":["Container","styled","div","SearchContainer","form","FormContainer","isValidPhoneNumber","value","phoneNumber","parsePhoneNumberFromString","metadata","isValid","CustomerSearch","useApi","get","clearData","fetchPhoneNumber","post","createPhone","searchInput","useRef","useEffect","current","focus","useState","setPhoneNumber","handleSearch","useCallback","e","a","preventDefault","number","response","length","customer","history","push","id","createResponse","onSubmit","ref","icon","onChange","variant","type","disabled"],"mappings":"+qBAEO,IAAMA,EAAYC,IAAOC,IAAV,KAMTC,EAAkBF,IAAOG,KAAV,KAQfC,EAAgBJ,IAAOC,IAAV,M,+HCbnB,SAASI,EAAmBC,GAC/B,IAAKA,EAAO,OAAO,EAEnB,IAAMC,EAAcC,YAA2BF,EAAOG,GACtD,QAAKF,GAEEA,EAAYG,U,sBCyCRC,UA3CQ,WAAO,IAAD,EAEeC,IAAOC,IAAI,WAF1B,mBAElBC,EAFkB,KAElBA,UAAaC,EAFK,OAGHH,IAAOI,KAAK,WAA3BC,EAHkB,oBAKrBC,EAAcC,iBAAO,MAC3BC,qBAAU,WACRF,EAAYG,QAAQC,UACnB,IARwB,MAUWC,mBAAS,QAVpB,mBAUpBhB,EAVoB,KAUPiB,EAVO,KAYrBC,EAAeC,sBAAW,uCAAC,WAAOC,GAAP,iBAAAC,EAAA,sDAC/B,IACMD,GAAGA,EAAEE,iBACT,UAH6B,OAM/Bf,IAN+B,SAORC,EAAiB,CAAEe,OAAQvB,IAPnB,cAOzBwB,EAPyB,SAQd,IAAIC,OAAS,GARC,qBASzBD,EAAS,GAAGE,SATa,iCAUrBC,IAAQC,KAAR,qBAA2BJ,EAAS,GAAGE,WAVlB,gDAYrBC,IAAQC,KAAR,4BAAkCJ,EAAS,GAAGK,KAZzB,iDAeAnB,EAAY,CAAEa,OAAQvB,IAftB,eAevB8B,EAfuB,iBAgBvBH,IAAQC,KAAR,4BAAkCE,EAAeD,KAhB1B,4CAAD,sDAkB7B,CAACnB,EAAaH,EAAWC,EAAkBR,IAE9C,OAAO,kBAAC,IAAD,KACL,kBAAC,IAAD,CAAiB+B,SAAUb,GACzB,kBAAC,IAAD,CAAOc,IAAKrB,EAAasB,KAAK,QAAQC,SAAUjB,EAAgBlB,MAAOC,IACvE,kBAAC,IAAD,CAAQmC,QAAQ,UAAUC,KAAK,SAASC,UAAWvC,EAAmBE,IAAtE","file":"static/js/11.fce2d863.chunk.js","sourcesContent":["import styled from \"styled-components\"\n\nexport const Container = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 4fr 1fr;\n  height: 100%;\n`\n\nexport const SearchContainer = styled.form`\n  grid-column-start: 2;\n  display: grid;\n  grid-template-columns: 4fr 2fr;\n  gap: 25px;\n  align-items: center;\n`\n\nexport const FormContainer = styled.div`\n  display: grid;\n  grid-template-columns: 2fr 4fr 2fr;\n`\n","import {parsePhoneNumberFromString} from 'libphonenumber-js/core'\nimport metadata from 'libphonenumber-js/metadata.min.json'\n\nexport function isValidPhoneNumber(value) {\n    if (!value) return false\n\n    const phoneNumber = parsePhoneNumberFromString(value, metadata)\n    if (!phoneNumber) return false\n\n    return phoneNumber.isValid()\n}\n","import React, { useCallback, useEffect, useRef, useState } from \"react\"\nimport history from \"../../../history\"\nimport { Button, Input } from \"../../../shared/components\"\nimport { isValidPhoneNumber } from \"../../../shared/utils/phoneNumberValidation\"\nimport { Container, SearchContainer } from \"./Styles\"\nimport useApi from \"../../../shared/hooks/api\"\n\nconst CustomerSearch = () => {\n\n  const [{ clearData }, fetchPhoneNumber] = useApi.get(\"/phone/\")\n  const [, createPhone] = useApi.post(\"/phone/\")\n\n  const searchInput = useRef(null)\n  useEffect(() => {\n    searchInput.current.focus()\n  }, [])\n\n  const [phoneNumber, setPhoneNumber] = useState(\"+380\")\n\n  const handleSearch = useCallback(async (e) => {\n    try {\n      if (e) e.preventDefault()\n    } catch {\n      // pass\n    }\n    clearData()\n    const response = await fetchPhoneNumber({ number: phoneNumber })\n    if ((response || []).length > 0) {\n      if (response[0].customer) {\n        await history.push(`/customers/${response[0].customer}`)\n      } else {\n        await history.push(`/customers/create/${response[0].id}`)\n      }\n    } else {\n      const createResponse = await createPhone({ number: phoneNumber })\n      await history.push(`/customers/create/${createResponse.id}`)\n    }\n  }, [createPhone, clearData, fetchPhoneNumber, phoneNumber])\n\n  return <Container>\n    <SearchContainer onSubmit={handleSearch}>\n      <Input ref={searchInput} icon=\"phone\" onChange={setPhoneNumber} value={phoneNumber} />\n      <Button variant=\"primary\" type=\"submit\" disabled={!isValidPhoneNumber(phoneNumber)}>\n        Найти\n      </Button>\n    </SearchContainer>\n  </Container>\n\n}\n\nexport default CustomerSearch"],"sourceRoot":""}