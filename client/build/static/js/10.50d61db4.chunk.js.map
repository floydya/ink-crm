{"version":3,"sources":["pages/Customer/Create/Styles.js","pages/Customer/Create/CustomerCreateForm.jsx"],"names":["Container","styled","div","SearchContainer","form","FormContainer","CustomerCreateForm","phoneNumber","useParams","profile","useCurrentProfile","useApi","get","mountFetch","data","useEffect","customer","history","push","findOuts","post","isCreating","createCustomer","findOutOptions","useMemo","map","el","label","name","value","id","validations","full_name","Form","is","required","email","find_out","initialValues","birth_date","moment","note","onSubmit","values","a","console","log","phone","created_by","formatDate","response","handleAPIError","style","gridColumn","icon","disabled","number","Field","Input","type","Select","options","DatePicker","withTime","Textarea","variant","isWorking"],"mappings":"+qBAEO,IAAMA,EAAYC,IAAOC,IAAV,KAMTC,EAAkBF,IAAOG,KAAV,KAQfC,EAAgBJ,IAAOC,IAAV,M,kMCgEXI,UApEY,WAAO,IACxBC,EAAgBC,cAAhBD,YACFE,EAAUC,cAFe,EAGZC,IAAOC,IAAP,iBAAqBL,EAArB,KAAqC,GAAI,CAAEM,YAAY,IAAjEC,EAHsB,oBAGtBA,KAETC,qBAAU,WACJD,GAAQA,EAAKE,UACfC,IAAQC,KAAR,qBAA2BJ,EAAKE,aAEjC,CAACF,IAT2B,MAWFH,IAAOC,IAAP,oBAAgC,GAAI,CAAEC,YAAY,IAAhEM,EAXgB,oBAWtBL,KAXsB,EAYUH,IAAOS,KAAP,eAZV,mBAYtBC,EAZsB,KAYtBA,WAAcC,EAZQ,KAczBC,EAAiBC,mBACrB,kBAAOL,GAAY,IAAIM,KAAI,SAAAC,GAAE,MAAK,CAAEC,MAAOD,EAAGE,KAAMC,MAAOH,EAAGI,SAC9D,CAACX,IAGH,OAAO,kBAAC,IAAD,KACL,kBAAC,IAAD,CACEY,YAAa,CACXC,UAAWC,IAAKC,GAAGC,WACnBC,MAAOH,IAAKC,GAAGE,QACfC,SAAUJ,IAAKC,GAAGC,YAEpBG,cAAe,CACbN,UAAW,GACXI,MAAO,GACPC,SAAU,GACVE,WAAYC,MACZC,KAAM,IAERC,SAAQ,uCAAE,WAAOC,EAAQvC,GAAf,eAAAwC,EAAA,6DACRC,QAAQC,IAAIH,GADJ,kBAGiBrB,EAAe,eACjCqB,EADgC,CAEnCI,MAAOxC,EACPyC,WAAYvC,EAAQqB,GACpBS,WAAYU,YAAWN,EAAOJ,WAAY,iBAPtC,cAGAW,EAHA,gBASAjC,IAAQC,KAAR,qBAA2BgC,EAASpB,KATpC,uDAWNG,IAAKkB,eAAL,KAA2B/C,GAXrB,yDAAF,yDAeR,kBAAC,IAAD,CAAagD,MAAO,CAAEC,WAAY,MAChC,kBAAC,IAAD,oGACCvC,GAAQ,kBAAC,IAAD,CAAOwC,KAAK,QAAQC,UAAQ,EAAC1B,MAAOf,EAAK0C,SAClD,kBAAC,IAAKC,MAAMC,MAAZ,CAAkB9B,KAAK,YAAYD,MAAM,uBACzC,kBAAC,IAAK8B,MAAMC,MAAZ,CAAkB9B,KAAK,QAAQD,MAAM,QAAQgC,KAAK,UAClD,kBAAC,IAAKF,MAAMG,OAAZ,CAAmBhC,KAAK,WAAWD,MAAM,uEAAgBkC,QAAStC,IAClE,kBAAC,IAAKkC,MAAMK,WAAZ,CAAuBlC,KAAK,aAAaD,MAAM,4EAAgBoC,UAAU,IACzE,kBAAC,IAAKN,MAAMO,SAAZ,CAAqBpC,KAAK,OAAOD,MAAM,+CACvC,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAcgC,KAAK,SAASM,QAAQ,UAAUC,UAAW7C,GAAzD","file":"static/js/10.50d61db4.chunk.js","sourcesContent":["import styled from \"styled-components\"\n\nexport const Container = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 4fr 1fr;\n  height: 100%;\n`\n\nexport const SearchContainer = styled.form`\n  grid-column-start: 2;\n  display: grid;\n  grid-template-columns: 4fr 2fr;\n  gap: 25px;\n  align-items: center;\n`\n\nexport const FormContainer = styled.div`\n  display: grid;\n  grid-template-columns: 2fr 4fr 2fr;\n`\n","import React, { useEffect, useMemo } from \"react\"\nimport { useParams } from \"react-router-dom\"\nimport { ActionButton, Actions, FormElement, FormHeading } from \"../../Authentication/Styles\"\nimport Input from \"../../../shared/components/Input\"\nimport useApi from \"../../../shared/hooks/api\"\nimport { FormContainer } from \"./Styles\"\nimport Form from \"../../../shared/components/Form\"\nimport moment from \"moment\"\nimport { formatDate } from \"../../../shared/utils/dateTime\"\nimport { useCurrentProfile } from \"../../../shared/hooks/currentUser\"\nimport history from \"../../../history\"\n\nconst CustomerCreateForm = () => {\n  const { phoneNumber } = useParams()\n  const profile = useCurrentProfile()\n  const [{ data }] = useApi.get(`/phone/${phoneNumber}/`, {}, { mountFetch: true })\n\n  useEffect(() => {\n    if (data && data.customer) {\n      history.push(`/customers/${data.customer}`)\n    }\n  }, [data])\n\n  const [{ data: findOuts }] = useApi.get(`/types/find-outs/`, {}, { mountFetch: true })\n  const [{ isCreating }, createCustomer] = useApi.post(`/customers/`)\n\n  const findOutOptions = useMemo(\n    () => (findOuts || []).map(el => ({ label: el.name, value: el.id })),\n    [findOuts]\n  )\n\n  return <FormContainer>\n    <Form\n      validations={{\n        full_name: Form.is.required(),\n        email: Form.is.email(),\n        find_out: Form.is.required()\n      }}\n      initialValues={{\n        full_name: \"\",\n        email: \"\",\n        find_out: \"\",\n        birth_date: moment(),\n        note: \"\"\n      }}\n      onSubmit={async (values, form) => {\n        console.log(values)\n        try {\n          const response = await createCustomer({\n            ...values,\n            phone: phoneNumber,\n            created_by: profile.id,\n            birth_date: formatDate(values.birth_date, \"YYYY-MM-DD\")\n          })\n          await history.push(`/customers/${response.id}`)\n        } catch (error) {\n          Form.handleAPIError(error, form)\n        }\n      }}\n    >\n      <FormElement style={{ gridColumn: \"2\" }}>\n        <FormHeading>Создание клиента</FormHeading>\n        {data && <Input icon=\"phone\" disabled value={data.number} />}\n        <Form.Field.Input name=\"full_name\" label=\"ФИО\" />\n        <Form.Field.Input name=\"email\" label=\"Email\" type=\"email\" />\n        <Form.Field.Select name=\"find_out\" label=\"Откуда узнал?\" options={findOutOptions} />\n        <Form.Field.DatePicker name=\"birth_date\" label=\"Дата рождения\" withTime={false} />\n        <Form.Field.Textarea name=\"note\" label=\"Заметка\" />\n        <Actions>\n          <ActionButton type=\"submit\" variant=\"primary\" isWorking={isCreating}>\n            Создать\n          </ActionButton>\n        </Actions>\n      </FormElement>\n    </Form>\n  </FormContainer>\n\n\n}\n\nexport default CustomerCreateForm"],"sourceRoot":""}