(this["webpackJsonpink-crm"]=this["webpackJsonpink-crm"]||[]).push([[12],{113:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(5),l=n(0),r=n.n(l),c=n(28),i=n(21),o=function(){var e=Object(l.useState)(!1),t=Object(a.a)(e,2),n=t[0],r=t[1];return Object(l.useMemo)((function(){return{open:function(){return r(!0)},close:function(){return r(!1)},isOpen:function(){return!0===n}}}),[n])},s=[{Header:"ID",accessor:"id",width:50,className:"text-center"},{Header:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435",accessor:"created_at",Cell:function(e){var t=e.row.original,n=t.created_at,a=t.created_by;return r.a.createElement("div",null,r.a.createElement("p",null,a.full_name),r.a.createElement("p",null,Object(i.b)(n,"DD.MM.YYYY HH:mm:ss")))},width:200},{Header:"\u0422\u0438\u043f",accessor:"type",Cell:function(e){return e.cell.value.name},width:200},{Header:"\u0417\u0430\u043c\u0435\u0442\u043a\u0430",accessor:"note"},{Header:"\u0421\u0443\u043c\u043c\u0430",accessor:"amount",className:"text-right"},{Header:"\u0421\u0441\u044b\u043b\u043a\u0430",accessor:"href",Cell:function(e){var t=e.cell.value,n=Object(l.useCallback)((function(){return window.open(t)}),[t]);return r.a.createElement(c.a,{disabled:!t,variant:"secondary",icon:"link",onClick:n},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438")},className:"text-center"}]},168:function(e,t,n){"use strict";n.r(t);var a=n(5),l=n(0),r=n.n(l),c=n(27),i=n(56),o=n(109),s=n(37),u=n(2);function m(){var e=Object(u.a)(["\n  padding: 15px;\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 10px;\n  \n  table {\n    border: none;\n    background: white;\n    width: 100%;\n    \n    caption {\n      margin-bottom: 10px;\n    }\n  }\n \n  thead {\n    background-color: rgba(0, 0, 0, 0.02);\n    \n    th {\n      font-weight: 600;\n    }\n  }\n  \n  th, td {\n    font-size: 12px;\n    line-height: 20px;\n  }\n  \n  th {\n    padding: 8px;\n  }\n  td {\n    padding: 12px;\n  }\n  \n  tr.date-block {\n    background-color: rgba(0, 0, 0, 0.04);\n  }\n"]);return m=function(){return e},e}var d=n(3).c.div(m()),p=n(33),v=n.n(p),b=n(60),f=n(113),E=n(39),y=n(38),h=n.n(y),O=n(20),C=n(112),g=n(57),j=n(110),_=function(e){var t,n,c=e.types,i=e.href,s=e.motivation,u=void 0===s?null:s,m=e.employee,d=e.modalClose,p=o.a.patch("/motivation/".concat(i,"/").concat(null===u||void 0===u?void 0:u.id,"/")),b=Object(a.a)(p,2),f=b[0].isUpdating,E=b[1],y=o.a.post("/motivation/".concat(i,"/")),_=Object(a.a)(y,2),x=_[0].isCreating,S=_[1],k=Object(l.useMemo)((function(){return(null===u||void 0===u?void 0:u.id)?[f,E]:[x,S]}),[u,f,x,E,S]),w=Object(a.a)(k,2),N=w[0],I=w[1];return r.a.createElement("div",null,r.a.createElement(g.a,{enableReinitialize:!0,initialValues:{employee:m,session_type:(null===u||void 0===u?void 0:null===(t=u.session_type)||void 0===t?void 0:t.id)||"",base_percent:(null===u||void 0===u?void 0:u.base_percent)||"",invite_percent:(null===u||void 0===u?void 0:u.invite_percent)||""},validations:{session_type:g.a.is.required(),base_percent:g.a.is.required(),invite_percent:g.a.is.required()},onSubmit:function(){var e=Object(C.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I(Object(O.a)({},t));case 3:return e.next=5,v.a.emit("fetch-profile");case 5:d(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),g.a.handleAPIError(e.t0,n);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}()},r.a.createElement(j.e,null,r.a.createElement(j.f,null,(null===u||void 0===u?void 0:u.id)?"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043c\u043e\u0442\u0438\u0432\u0430\u0446\u0438\u0438":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043c\u043e\u0442\u0438\u0432\u0430\u0446\u0438\u0438"),r.a.createElement(g.a.Field.Select,{options:(null===u||void 0===u?void 0:u.id)?[{label:null===u||void 0===u?void 0:u.session_type.name,value:null===u||void 0===u?void 0:null===(n=u.session_type)||void 0===n?void 0:n.id}]:c,name:"session_type",label:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",disabled:null===u||void 0===u?void 0:u.id}),r.a.createElement(g.a.Field.Input,{type:"number",name:"base_percent",label:"\u0411\u0430\u0437\u043e\u0432\u044b\u0439 \u043f\u0440\u043e\u0446\u0435\u043d\u0442"}),r.a.createElement(g.a.Field.Input,{type:"number",name:"invite_percent",label:"\u041f\u0440\u043e\u0446\u0435\u043d\u0442 \u0437\u0430 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435"}),r.a.createElement(j.b,null,r.a.createElement(j.a,{type:"submit",variant:"primary",isWorking:N},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")))))},x=function(e){var t,n,c=e.types,i=e.motivation,s=void 0===i?null:i,u=e.employee,m=e.modalClose,d=o.a.patch("/motivation/sells/".concat(null===s||void 0===s?void 0:s.id,"/")),p=Object(a.a)(d,2),b=p[0].isUpdating,f=p[1],E=o.a.post("/motivation/sells/"),y=Object(a.a)(E,2),_=y[0].isCreating,x=y[1],S=Object(l.useMemo)((function(){return(null===s||void 0===s?void 0:s.id)?[b,f]:[_,x]}),[s,b,_,f,x]),k=Object(a.a)(S,2),w=k[0],N=k[1];return r.a.createElement("div",null,r.a.createElement(g.a,{enableReinitialize:!0,initialValues:{sell_category:(null===s||void 0===s?void 0:null===(t=s.sell_category)||void 0===t?void 0:t.id)||"",base_percent:(null===s||void 0===s?void 0:s.base_percent)||""},validations:{sell_category:g.a.is.required(),base_percent:g.a.is.required()},onSubmit:function(){var e=Object(C.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N(Object(O.a)({},t,{employee:u}));case 3:return e.next=5,v.a.emit("fetch-profile");case 5:m(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),g.a.handleAPIError(e.t0,n);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}()},r.a.createElement(j.e,null,r.a.createElement(j.f,null,(null===s||void 0===s?void 0:s.id)?"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043c\u043e\u0442\u0438\u0432\u0430\u0446\u0438\u0438":"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043c\u043e\u0442\u0438\u0432\u0430\u0446\u0438\u0438"),r.a.createElement(g.a.Field.Select,{options:(null===s||void 0===s?void 0:s.id)?[{label:null===s||void 0===s?void 0:s.sell_category.name,value:null===s||void 0===s?void 0:null===(n=s.sell_category)||void 0===n?void 0:n.id}]:c,name:"sell_category",label:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",disabled:null===s||void 0===s?void 0:s.id}),r.a.createElement(g.a.Field.Input,{type:"number",name:"base_percent",label:"\u041f\u0440\u043e\u0446\u0435\u043d\u0442"}),r.a.createElement(j.b,null,r.a.createElement(j.a,{type:"submit",variant:"primary",isWorking:w},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")))))},S=function(e){var t=e.session,n=e.types,c=e.employee,i=Object(f.b)(),u=o.a.delete("/motivation/sessions/".concat(null===t||void 0===t?void 0:t.id,"/")),m=Object(a.a)(u,2)[1],d=Object(l.useCallback)((function(){m().then((function(){return v.a.emit("fetch-profile")}))}),[m]);return r.a.createElement("tr",null,r.a.createElement("td",{colSpan:2},t.session_type.name),r.a.createElement("td",{colSpan:1,className:"text-center"},t.base_percent," %"),r.a.createElement("td",{colSpan:1,className:"text-center"},t.invite_percent," %"),r.a.createElement("td",{colSpan:1,className:"text-center",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},r.a.createElement(s.b,{icon:"edit",iconSize:12,variant:"primary",onClick:i.open}),r.a.createElement(s.b,{icon:"trash",iconSize:12,variant:"danger",onClick:d}),i.isOpen()&&r.a.createElement(E.a,{isOpen:!0,withCloseIcon:!0,width:600,onClose:i.close,renderContent:function(e){var a=e.close;return r.a.createElement(_,{modalClose:a,href:"sessions",employee:c,motivation:t,types:n})}})))},k=function(e){var t=e.employee,n=e.sessions,c=Object(f.b)(),i=o.a.get("/types/sessions/",{},{mountFetch:!0}),u=Object(a.a)(i,1)[0].data,m=Object(l.useMemo)((function(){return(u||[]).map((function(e){return{value:e.id,label:e.name}})).filter((function(e){return!n.find((function(t){var n;return(null===(n=t.session_type)||void 0===n?void 0:n.id)===e.value}))}))}),[n,u]);return r.a.createElement("table",null,r.a.createElement("caption",null,"\u0421\u0435\u0430\u043d\u0441\u044b"),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{colSpan:2},"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"),r.a.createElement("th",{colSpan:1,className:"text-center"},"\u041f\u0440\u043e\u0446\u0435\u043d\u0442"),r.a.createElement("th",{colSpan:1,className:"text-center"},"\u041f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435"),r.a.createElement("th",{colSpan:1}))),r.a.createElement("tbody",null,n.map((function(e){return r.a.createElement(S,{session:e,types:m,employee:t})}))),m.length>0&&r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:5,className:"text-center"},r.a.createElement(s.b,{icon:"plus-square",variant:"empty",onClick:c.open},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),c.isOpen()&&r.a.createElement(E.a,{isOpen:!0,withCloseIcon:!0,width:600,onClose:c.close,renderContent:function(e){var n=e.close;return r.a.createElement(_,{modalClose:n,href:"sessions",employee:t,types:m})}})))))},w=function(e){var t=e.employee,n=e.education,c=e.types,i=Object(f.b)(),u=o.a.delete("/motivation/educations/".concat(null===n||void 0===n?void 0:n.id,"/")),m=Object(a.a)(u,2)[1],d=Object(l.useCallback)((function(){m().then((function(){return v.a.emit("fetch-profile")}))}),[m]);return r.a.createElement("tr",null,r.a.createElement("td",{colSpan:2},n.session_type.name),r.a.createElement("td",{colSpan:1,className:"text-center"},n.base_percent," %"),r.a.createElement("td",{colSpan:1,className:"text-center"},n.invite_percent," %"),r.a.createElement("td",{colSpan:1,className:"text-center",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},r.a.createElement(s.b,{icon:"edit",iconSize:12,variant:"primary",onClick:i.open}),r.a.createElement(s.b,{icon:"trash",iconSize:12,variant:"danger",onClick:d}),i.isOpen()&&r.a.createElement(E.a,{isOpen:!0,withCloseIcon:!0,width:600,onClose:i.close,renderContent:function(e){var a=e.close;return r.a.createElement(_,{modalClose:a,href:"educations",employee:t,motivation:n,types:c})}})))},N=function(e){var t=e.educations,n=e.employee,c=Object(f.b)(),i=o.a.get("/types/sessions/",{},{mountFetch:!0}),u=Object(a.a)(i,1)[0].data,m=Object(l.useMemo)((function(){return(u||[]).map((function(e){return{value:e.id,label:e.name}})).filter((function(e){return!t.find((function(t){var n;return(null===(n=t.session_type)||void 0===n?void 0:n.id)===e.value}))}))}),[t,u]);return r.a.createElement("table",null,r.a.createElement("caption",null,"\u041e\u0431\u0443\u0447\u0435\u043d\u0438\u0435"),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{colSpan:2},"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"),r.a.createElement("th",{colSpan:1,className:"text-center"},"\u041f\u0440\u043e\u0446\u0435\u043d\u0442"),r.a.createElement("th",{colSpan:1,className:"text-center"},"\u041f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435"),r.a.createElement("th",{colSpan:1}))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement(w,{education:e,types:m,employee:n})}))),m.length>0&&r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:5,className:"text-center"},r.a.createElement(s.b,{icon:"plus-square",variant:"empty",onClick:c.open},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),c.isOpen()&&r.a.createElement(E.a,{isOpen:!0,withCloseIcon:!0,width:600,onClose:c.close,renderContent:function(e){var t=e.close;return r.a.createElement(_,{modalClose:t,href:"educations",employee:n,types:m})}})))))},I=function(e){var t=e.sell,n=e.types,c=e.employee,i=Object(f.b)(),u=o.a.delete("/motivation/sells/".concat(null===t||void 0===t?void 0:t.id,"/")),m=Object(a.a)(u,2)[1],d=Object(l.useCallback)((function(){m().then((function(){return v.a.emit("fetch-profile")}))}),[m]);return r.a.createElement("tr",null,r.a.createElement("td",{colSpan:2},t.sell_category.name),r.a.createElement("td",{colSpan:1,className:"text-center"},t.base_percent," %"),r.a.createElement("td",{colSpan:1,className:"text-center",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},r.a.createElement(s.b,{icon:"edit",iconSize:12,variant:"primary",onClick:i.open}),r.a.createElement(s.b,{icon:"trash",iconSize:12,variant:"danger",onClick:d}),i.isOpen()&&r.a.createElement(E.a,{isOpen:!0,withCloseIcon:!0,width:600,onClose:i.close,renderContent:function(e){var a=e.close;return r.a.createElement(x,{modalClose:a,employee:c,motivation:t,types:n})}})))},z=function(e){var t=e.employee,n=e.sells,c=Object(f.b)(),i=o.a.get("/store/categories/",{},{mountFetch:!0}),u=Object(a.a)(i,1)[0].data,m=Object(l.useMemo)((function(){return(u||[]).map((function(e){return{value:e.id,label:e.name}})).filter((function(e){return!n.find((function(t){var n;return(null===(n=t.sell_category)||void 0===n?void 0:n.id)===e.value}))}))}),[n,u]);return r.a.createElement("table",null,r.a.createElement("caption",null,"\u0421\u0435\u0430\u043d\u0441\u044b"),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{colSpan:2},"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"),r.a.createElement("th",{colSpan:1,className:"text-center"},"\u041f\u0440\u043e\u0446\u0435\u043d\u0442"),r.a.createElement("th",{colSpan:1}))),r.a.createElement("tbody",null,n.map((function(e){return r.a.createElement(I,{sell:e,types:m,employee:t})}))),m.length>0&&r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:5,className:"text-center"},r.a.createElement(s.b,{icon:"plus-square",variant:"empty",onClick:c.open},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),c.isOpen()&&r.a.createElement(E.a,{isOpen:!0,withCloseIcon:!0,width:600,onClose:c.close,renderContent:function(e){var n=e.close;return r.a.createElement(x,{modalClose:n,employee:t,types:m})}})))))};t.default=function(){var e=Object(c.h)().employeeId,t=Object(l.useContext)(i.a).parlor,n=o.a.get("/users/".concat(e,"/"),{},{mountFetch:!0}),u=Object(a.a)(n,2),m=u[0],p=m.isLoading,f=m.data,E=m.error,y=u[1];if(Object(l.useEffect)((function(){return v.a.on("fetch-profile",y),function(){return v.a.off("fetch-profile",y)}}),[y]),p)return r.a.createElement(s.j,null);if(E)return r.a.createElement(s.i,null);var h=f.profile.find((function(e){return e.parlor.id===t}));if(!h)return r.a.createElement(s.i,null);var O=h.session_motivations,C=h.education_motivations,g=h.sell_motivations;return r.a.createElement("div",null,r.a.createElement(b.a,{items:[{name:"\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438",link:"/employees"},{name:f.full_name,link:"/employees/".concat(e)},{name:"\u041c\u043e\u0442\u0438\u0432\u0430\u0446\u0438\u044f"}]}),r.a.createElement(d,null,r.a.createElement(k,{employee:h.id,sessions:O}),r.a.createElement(N,{employee:h.id,educations:C}),r.a.createElement(z,{employee:h.id,sells:g})))}}}]);
//# sourceMappingURL=12.f05a5806.chunk.js.map